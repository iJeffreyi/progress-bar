<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图表幻灯片展示</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        .slideshow-container {
            position: relative;
            width: 700px;
            height: 510px;
            margin: 20px auto;
        }

        /* 幻灯片项样式 - 使用透明度和层级控制显示 */
        .slide-item {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            visibility: hidden;
            opacity: 0;
            transition: visibility 0s 0.3s, opacity 0.3s ease;
        }

        .slide-item.active {
            z-index: 2;
            visibility: visible;
            opacity: 1;
            transition: visibility 0s, opacity 0.3s ease;
        }

        /* iframe样式确保正确显示 */
        .slide-item iframe {
            width: 100% !important;
            height: 100% !important;
            border: none;
            display: block;
        }

        /* 导航按钮 */
        .nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 45px;
            height: 45px;
            background-color: rgba(255, 255, 255, 0.7);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }

        .nav-btn:hover {
            background-color: white;
            transform: translateY(-50%) scale(1.1);
        }

        .prev-btn {
            left: 15px;
        }

        .next-btn {
            right: 15px;
        }

        /* 指示器 */
        .indicators {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            z-index: 10;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s;
        }

        .indicator.active {
            background-color: white;
            transform: scale(1.3);
        }
    </style>
</head>
<body>
    <div class="slideshow-container">
        <!-- 幻灯片内容 -->
        <div class="slide-item active">
            <iframe src="https://dycharts.com/xshow/index.html?id=c_6edbca6b169a667dd11fe6ff5ad18be0" scrolling="no"></iframe>
        </div>
        <div class="slide-item">
            <iframe src="https://dycharts.com/xshow/index.html?id=c_8f55f9d9e3e42a358692284e78368c5e" scrolling="no"></iframe>
        </div>
        <div class="slide-item">
            <iframe src="https://dycharts.com/xshow/index.html?id=c_e2661d3afcc02db4d01b14d9310769f3" scrolling="no"></iframe>
        </div>
        <div class="slide-item">
            <iframe src="https://dycharts.com/xshow/index.html?id=c_876afc463dd11f7246ee5dfa52921d8a" scrolling="no"></iframe>
        </div>

        <!-- 导航按钮 -->
        <button class="nav-btn prev-btn" id="prevBtn">
            <i class="fa fa-angle-left text-xl"></i>
        </button>
        <button class="nav-btn next-btn" id="nextBtn">
            <i class="fa fa-angle-right text-xl"></i>
        </button>

        <!-- 指示器容器 -->
        <div class="indicators" id="indicatorsContainer"></div>
    </div>

    <script>
        // 初始化变量
        const slides = document.querySelectorAll('.slide-item');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const indicatorsContainer = document.getElementById('indicatorsContainer');
        let currentIndex = 0;
        let isTransitioning = false; // 防止快速点击导致的冲突

        // 创建指示器
        function createIndicators() {
            slides.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.className = `indicator ${index === 0 ? 'active' : ''}`;
                indicator.addEventListener('click', () => {
                    if (!isTransitioning && index !== currentIndex) {
                        goToSlide(index);
                    }
                });
                indicatorsContainer.appendChild(indicator);
            });
        }

        // 切换到指定幻灯片
        function goToSlide(index) {
            if (isTransitioning) return;
            
            isTransitioning = true;
            
            // 移除当前激活状态
            slides[currentIndex].classList.remove('active');
            document.querySelectorAll('.indicator')[currentIndex].classList.remove('active');
            
            // 更新索引
            currentIndex = index;
            
            // 设置新激活状态
            slides[currentIndex].classList.add('active');
            document.querySelectorAll('.indicator')[currentIndex].classList.add('active');
            
            // 触发iframe重绘确保图表正确显示
            triggerIframeRedraw(slides[currentIndex].querySelector('iframe'));
            
            // 过渡完成后重置状态
            setTimeout(() => {
                isTransitioning = false;
            }, 300); // 与CSS过渡时间匹配
        }

        // 触发iframe重绘
        function triggerIframeRedraw(iframe) {
            if (!iframe || !iframe.contentWindow) return;
            
            try {
                // 触发resize事件
                const event = new Event('resize');
                iframe.contentWindow.dispatchEvent(event);
                
                // 强制重绘
                iframe.style.display = 'none';
                iframe.offsetHeight; // 触发重排
                iframe.style.display = 'block';
            } catch (e) {
                // 跨域可能导致错误，不影响功能
                console.log('iframe重绘:', e);
            }
        }

        // 下一张幻灯片
        function nextSlide() {
            if (isTransitioning) return;
            const newIndex = (currentIndex + 1) % slides.length;
            goToSlide(newIndex);
        }

        // 上一张幻灯片
        function prevSlide() {
            if (isTransitioning) return;
            const newIndex = (currentIndex - 1 + slides.length) % slides.length;
            goToSlide(newIndex);
        }

        // 绑定事件
        prevBtn.addEventListener('click', prevSlide);
        nextBtn.addEventListener('click', nextSlide);

        // 初始化iframe加载处理
        function initIframes() {
            slides.forEach((slide) => {
                const iframe = slide.querySelector('iframe');
                // 确保iframe尺寸正确
                iframe.width = '700';
                iframe.height = '510';
                
                // 加载完成后处理
                iframe.onload = function() {
                    // 如果是当前激活的幻灯片，触发重绘
                    if (slide.classList.contains('active')) {
                        triggerIframeRedraw(iframe);
                    }
                };
            });
        }

        // 初始化
        createIndicators();
        initIframes();
    </script>
</body>
</html>
    